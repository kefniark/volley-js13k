!function(t){var s={};function i(e){if(s[e])return s[e].exports;var h=s[e]={i:e,l:!1,exports:{}};return t[e].call(h.exports,h,h.exports,i),h.l=!0,h.exports}i.m=t,i.c=s,i.d=function(t,s,e){i.o(t,s)||Object.defineProperty(t,s,{enumerable:!0,get:e})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,s){if(1&s&&(t=i(t)),8&s)return t;if(4&s&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(i.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&s&&"string"!=typeof t)for(var h in t)i.d(e,h,function(s){return t[s]}.bind(null,h));return e},i.n=function(t){var s=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(s,"a",s),s},i.o=function(t,s){return Object.prototype.hasOwnProperty.call(t,s)},i.p="",i(i.s=0)}([function(t,s,i){"use strict";i.r(s);class e{constructor(t){this.active=!1,this.updates=[],this.s=t}update(t,s){}render(t){}}class h extends e{constructor(t,s,i=0,e=0){super(t),this.img=x.sprites[s],this.x=i,this.y=e}render(t){this.s.ctx.drawImage(this.img,-this.img.width/2+this.x,-this.img.height/2+this.y,this.img.width,this.img.height)}}class r extends e{constructor(t){super(t),this.t={x:0,y:0,z:0,r:0,s:1,a:1,set(t){t&&(t.x&&(this.x=t.x),t.y&&(this.y=t.y),t.z&&(this.z=t.z),t.s&&(this.s=t.s),t.a&&(this.a=t.a),t.r&&(this.r=t.r))}},this.c=[],this.childrens=[],this.active=!0,this.s=t}add(t){t.e=this,this.c.push(t)}update(t,s){this.active&&(this.c.forEach(i=>i.update(t,s)),this.childrens.forEach(i=>i.update(t,s)))}instSprite(t,s,i=0,e=0){const n=new r(this.s);n.t.set(s);const o=new h(this.s,t,i,e);return n.add(o),this.childrens.push(n),n}instEntity(t){const s=new r(this.s);return s.t.set(t),this.childrens.push(s),s}render(t){if(!this.active)return;const s=t*this.t.a;this.s.ctx.translate(this.t.x,this.t.y),0!==this.t.r&&this.s.ctx.rotate(this.t.r),1!==this.t.s&&this.s.ctx.scale(this.t.s,this.t.s),this.t.a<1&&(this.s.ctx.globalAlpha=s),this.c.forEach(t=>t.render(s)),this.childrens.sort((t,s)=>t.t.z>s.t.z?1:-1),this.childrens.forEach(t=>t.render(s)),this.t.a<1&&(this.s.ctx.globalAlpha=1),1!==this.t.s&&this.s.ctx.scale(1/this.t.s,1/this.t.s),0!==this.t.r&&this.s.ctx.rotate(-this.t.r),this.s.ctx.translate(-this.t.x,-this.t.y)}}class n extends r{constructor(t,s){super(void 0),this.r=!1,this.s=this,this.can=t,this.ctx=s;for(let t=0;t<200;t++)this.instSprite(x.s[0],{x:320,y:180})}render(t){this.r||(this.ctx.clearRect(0,0,this.can.width,this.can.height),super.render(t),this.r=!0)}}class o extends e{constructor(t,s){super(t),this.radius=10,this.vv=0,this.hv=1,this.grounded=!1,this.wasGrounded=!1,this.floor=s,this.play=!1,this.wasGrounded=!1}reset(t,s){const i=this.e;i&&(i.t.x=t,i.t.y=s,this.play=!1,this.grounded=!1,this.wasGrounded=!1,this.vv=0,this.hv=1)}set(t,s){if(this.play=!0,this.grounded)return;this.eBounceCb&&this.eBounceCb(),this.hv=.26*t,this.vv=.27*s;const i=this.e;i&&(i.t.x+=this.hv,i.t.y-=this.vv)}update(t,s){const i=this.e;i&&this.play&&(this.vv-=.012*s,i.t.x+=this.hv,i.t.y-=this.vv,i.t.y>=this.floor&&this.vv<0&&(this.vv=-1*this.vv*.6,this.hv*=.5,this.grounded=!0,this.eBounceCb&&!this.wasGrounded&&this.eBounceCb(),this.eGround&&!this.wasGrounded&&this.eGround(),this.wasGrounded=!0),i.t.x<=0&&(i.t.x=0,this.hv*=-1,this.eBounceCb&&this.eBounceCb()),i.t.x>=640&&(i.t.x=640,this.hv*=-1,this.eBounceCb&&this.eBounceCb()),i.t.x>=300&&i.t.x<=340&&i.t.y>170&&(i.t.y<175?this.vv*=-1:this.hv=Math.abs(this.hv)*Math.sign(i.t.x-320),this.eBounceCb&&this.eBounceCb()),i.t.y>this.floor&&(i.t.y=this.floor))}}class a extends e{constructor(t,s,i){super(t),this.radius=30,this.defaultY=-1,this.next=0,this.vv=0,this.jumped=0,this.min=s,this.max=i}setup(){this.e&&(this.defaultY=this.e.t.y)}move(t){this.next=t}moveStop(){this.next=0}jump(){!this.e||this.jumped>=1||(this.vv+=10,this.jumped+=1,this.jumpCb&&this.jumpCb(),this.vv>10&&(this.vv=10))}update(t,s){const i=this.e;i&&(0!==this.next&&(i.t.x+=this.next*s*.35,i.t.x<this.min&&(i.t.x=this.min),i.t.x>this.max&&(i.t.x=this.max)),(i.t.y<this.defaultY||0!==this.vv)&&(i.t.y-=this.vv,i.t.y>=this.defaultY?(i.t.y=this.defaultY,this.vv=0,this.jumped=0):this.vv-=.02*s))}}class c extends e{constructor(t,s){super(t),this.text=s}render(t){super.render(t),this.s.ctx.font="bold 30px impact",this.s.ctx.fillStyle="white",this.s.ctx.textAlign="center",this.s.ctx.fillText(this.text,0,0)}}const u=150,d=490,l=200,p=800;class y extends r{constructor(t,s){super(void 0),this.s1=0,this.s2=0,this.s=this,this.audioHit=x.audio[x.a[0]],this.audioJump=x.audio[x.a[1]],this.audioJump.volume=.001,this.can=t,this.ctx=s,this.cloud=this.instSprite(x.s[2],{x:Math.random()*p,y:30,s:.28,a:.9,r:0}),this.cloud2=this.instSprite(x.s[2],{x:Math.random()*p,y:28,s:.22,a:.75}),this.cloud3=this.instSprite(x.s[2],{x:Math.random()*p,y:15,s:.13,a:.6});const i=this.instSprite(x.s[3],{x:u,y:265,z:2,s:.75},-2,6);this.player1=new a(this.s,5,302),this.player1.jumpCb=(()=>this.audioJump.play()),i.add(this.player1);const e=this.instSprite(x.s[3],{x:450,y:265,z:2,s:.75},-2,6);this.player2=new a(this.s,338,635),this.player2.jumpCb=(()=>this.audioJump.play()),e.add(this.player2),this.player1.setup(),this.player2.setup(),this.current=this.player1;const h=this.instSprite(x.s[1],{x:320,y:1e3,z:10,s:.75},30,-50);this.ball=new o(this.s,290),h.add(this.ball),this.ball.eBounceCb=(()=>this.audioHit.play()),this.ball.eGround=(()=>setTimeout(()=>this.point(h.t.x>320?this.player1:this.player2),1200));const r=this.instEntity({x:70,y:235,s:.75,a:.6}),n=this.instEntity({x:565,y:235,s:.75,a:.6});this.score1=new c(this.s,"0"),r.add(this.score1),this.score2=new c(this.s,"0"),n.add(this.score2)}start(){document.addEventListener("keydown",t=>this.inputD(t),!1),document.addEventListener("keyup",t=>this.inputU(t),!1),this.current=Math.random()>=.5?this.player1:this.player2,this.current===this.player1?this.ball.reset(u,l):this.ball.reset(d,l),this.current===this.player1?this.score1.text+=" .":this.score2.text+=" ."}point(t){t===this.current?this.current===this.player1?this.s1++:this.s2++:this.current=t,this.score1.text=this.s1+"",this.score2.text=this.s2+"",this.current===this.player1?this.score1.text+=" .":this.score2.text+=" .",this.current===this.player1?this.ball.reset(u,l):this.ball.reset(d,l)}inputD(t){switch(t.keyCode){case 65:this.player1.move(-1);break;case 68:this.player1.move(1);break;case 87:this.player1.jump();break;case 37:this.player2.move(-1);break;case 39:this.player2.move(1);break;case 38:this.player2.jump()}}inputU(t){switch(t.keyCode){case 65:case 68:this.player1.moveStop();break;case 37:case 39:this.player2.moveStop()}}update(t,s){super.update(t,s),this.cloud.t.x-=.005*s,this.cloud.t.y=30+10*Math.sin(t/1e4),this.cloud.t.x<-100&&(this.cloud.t.x+=p),this.cloud2.t.x-=.003*s,this.cloud2.t.y=28+5*Math.sin(t/2e4),this.cloud2.t.x<-100&&(this.cloud2.t.x+=p),this.cloud3.t.x-=.0015*s,this.cloud3.t.y=15+3*Math.sin(t/3e4),this.cloud3.t.x<-100&&(this.cloud3.t.x+=p),this.collision()}distance(t,s){const i=t.x-s.x,e=t.y-s.y;return Math.sqrt(i*i+e*e)}collision(){const t=this.ball.e;for(const s of[this.player1,this.player2]){const i=s.e;if(!i||!t)return;this.distance(t.t,i.t)<this.ball.radius+this.player1.radius&&this.ball.set(t.t.x-i.t.x,i.t.y-t.t.y)}}render(t){this.ctx.clearRect(0,0,this.can.width,this.can.height),super.render(t)}}i.d(s,"loader",function(){return x});const x=new class{constructor(){this.s=["assets/background.svg","assets/ball.svg","assets/cloud.svg","assets/player.svg"],this.sprites={},this.a=["assets/hit.wav","assets/jump.wav"],this.audio={}}load(t){this.preloadImg(()=>this.preloadAudio(t))}preloadImg(t){let s=this.s.length;for(const i of this.s){const e=new Image;e.onload=(()=>{0==--s&&t()}),e.src=i,this.sprites[i]=e}}preloadAudio(t){let s=this.a.length;for(const i of this.a){const e=new Audio;e.onload=(()=>{0==--s&&t()}),e.src=i,this.audio[i]=e}t()}};!function(){let t,s;const i=[];let e=!0,h=0;function r(t,s){const e=document.getElementById(t);if(!e)return;const h=e.getContext("2d");h&&i.push(s(e,h))}function o(t){const s=t-h;if(h=t,e)for(const e of i)e.update(t,s),e.render(1);window.requestAnimationFrame(o)}function a(){t.r=!1;for(const i of[t,s]){const t=i.can,s=window.innerWidth,e=window.innerHeight;s/e>16/9?(i.t.s=e/360,t.width=16*e/9,t.height=e,t.style.left=(s-t.width)/2+"px",t.style.top="0px"):(i.t.s=s/640,t.width=s,t.height=s/16*9,t.style.left="0px",t.style.top=(e-t.height)/2+"px")}}x.load(()=>{r("background",(s,i)=>t=new n(s,i)),r("game",(t,i)=>s=new y(t,i)),s.can.style.left="320px",s.can.style.top="240px",a(),document.addEventListener("visibilitychange",()=>e=!document.hidden,!1),window.addEventListener("resize",a,!1),window.requestAnimationFrame(o),s.start()})}()}]);